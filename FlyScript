local plr = game.Players.LocalPlayer
local char = plr.Character or plr.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local rootPart = char:WaitForChild("HumanoidRootPart")
local flying = false
local speed = 5
local bodyVelocity, bodyGyro

-- 🛡️ Anti-Kick Bypass
local mt = getrawmetatable(game)
setreadonly(mt, false)
local oldNamecall = mt.__namecall
mt.__namecall = newcclosure(function(self, ...)
    if getnamecallmethod() == "Kick" then
        return nil
    end
    return oldNamecall(self, ...)
end)

-- UI Library
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local FlyButton = Instance.new("TextButton")
local UnflyButton = Instance.new("TextButton")
local SpeedLabel = Instance.new("TextLabel")
local IncreaseButton = Instance.new("TextButton")
local DecreaseButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")

-- UI Properties
ScreenGui.Parent = game.CoreGui

Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.Position = UDim2.new(0.1, 0, 0.5, 0)
Frame.Size = UDim2.new(0, 150, 0, 150)
Frame.Active = true
Frame.Draggable = true

FlyButton.Parent = Frame
FlyButton.Size = UDim2.new(0, 130, 0, 30)
FlyButton.Position = UDim2.new(0, 10, 0, 10)
FlyButton.Text = "Fly"
FlyButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
FlyButton.TextColor3 = Color3.new(1, 1, 1)

UnflyButton.Parent = Frame
UnflyButton.Size = UDim2.new(0, 130, 0, 30)
UnflyButton.Position = UDim2.new(0, 10, 0, 50)
UnflyButton.Text = "Unfly"
UnflyButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
UnflyButton.TextColor3 = Color3.new(1, 1, 1)

SpeedLabel.Parent = Frame
SpeedLabel.Size = UDim2.new(0, 130, 0, 20)
SpeedLabel.Position = UDim2.new(0, 10, 0, 90)
SpeedLabel.Text = "Speed: 5"
SpeedLabel.TextColor3 = Color3.new(1, 1, 1)

IncreaseButton.Parent = Frame
IncreaseButton.Size = UDim2.new(0, 60, 0, 25)
IncreaseButton.Position = UDim2.new(0, 80, 0, 120)
IncreaseButton.Text = "+"
IncreaseButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
IncreaseButton.TextColor3 = Color3.new(1, 1, 1)

DecreaseButton.Parent = Frame
DecreaseButton.Size = UDim2.new(0, 60, 0, 25)
DecreaseButton.Position = UDim2.new(0, 10, 0, 120)
DecreaseButton.Text = "-"
DecreaseButton.BackgroundColor3 = Color3.fromRGB(255, 150, 0)
DecreaseButton.TextColor3 = Color3.new(1, 1, 1)

CloseButton.Parent = Frame
CloseButton.Size = UDim2.new(0, 30, 0, 25)
CloseButton.Position = UDim2.new(0, 120, 0, 0)
CloseButton.Text = "X"
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.AutoButtonColor = true

-- 🛸 Fly Function
function fly()
    if flying then return end
    flying = true

    bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
    bodyVelocity.Parent = rootPart

    bodyGyro = Instance.new("BodyGyro")
    bodyGyro.MaxTorque = Vector3.new(4000, 4000, 4000)
    bodyGyro.Parent = rootPart

    game:GetService("RunService").Heartbeat:Connect(function()
        if flying then
            local moveDirection = humanoid.MoveDirection
            bodyVelocity.Velocity = (moveDirection * speed) + Vector3.new(0, speed / 2, 0)
            bodyGyro.CFrame = rootPart.CFrame
        end
    end)
end

-- 🛑 Unfly Function
function unfly()
    flying = false
    if bodyVelocity then bodyVelocity:Destroy() end
    if bodyGyro then bodyGyro:Destroy() end
end

-- 🔼 Increase Speed
IncreaseButton.MouseButton1Click:Connect(function()
    speed = speed + 1
    SpeedLabel.Text = "Speed: " .. speed
end)

-- 🔽 Decrease Speed
DecreaseButton.MouseButton1Click:Connect(function()
    if speed > 1 then
        speed = speed - 1
        SpeedLabel.Text = "Speed: " .. speed
    end
end)

-- ❌ Close UI (Mobile & PC Compatible)
CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)
CloseButton.TouchTap:Connect(function()
    ScreenGui:Destroy()
end)

-- 🎮 Button Click Functions
FlyButton.MouseButton1Click:Connect(fly)
UnflyButton.MouseButton1Click:Connect(unfly)
